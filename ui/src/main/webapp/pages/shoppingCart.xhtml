<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

<f:metadata>
	<f:viewParam name="userId" value="#{shoppingCartBean.userId}"></f:viewParam>
</f:metadata>

<ui:composition template="../template/template.xhtml">
	<ui:define name="head">
		<script src="../resources/js/cart.js"></script>
	</ui:define>

	<ui:define name="content">
		<div id="shopping-cart-content" class="container marketing style-font well">
		
			<div class="row">
				<div class="col-sm-12">
					<div class="cart-header product-list-cart">Lista produselor din cos:</div>
					<div id="cartProductsList" class="cart">
						<ui:repeat value="#{shoppingCartBean.getCartProductDetails()}" var="userDetails">
							<div class="user-item">
								<b>#{userDetails.username}</b>
							</div>

							<ui:repeat value="#{userDetails.cartDetails}" var="product">
								<div class="cart-row">
									<span>#{product.nrProducts}x #{product.productName} <i> (#{product.restaurantName} )</i></span> <span
										class="pull-right">#{product.nrProducts}x #{product.price} RON</span>
								</div>
							</ui:repeat>

							<div class="price-item">Subtotal: #{userDetails.totalPrice} RON</div>
						</ui:repeat>

					</div>
					<div class="user-item cart-row">
						<b>Total: #{shoppingCartBean.cartTotalPrice} RON</b>
					</div>


					<div class="row">
						<br></br> <br></br>

						<div class="col-sm-12">
							<button type="button" class="btn btn-block" data-toggle="modal" data-target="#sendCartModal">
								<h4>Trimite Comanda</h4>
							</button>
						</div>
					</div>

					<!-- comment list -->
					
				</div>
			</div>
			
		
			<!-- Modal checkout  -->
			<div class="container style-font row">
				<div class="modal fade" id="sendCartModal" role="dialog">
					<div class="modal-dialog ">

						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
							<h4 class="modal-title">Detalii livrare:</h4>
						</div>

						<div class="modal-content">
							<div class=" col-md-12">
								<p:growl id="growl" sticky="false" showDetail="true" life="3000" />
								<form data-toggle="validator" role="form">
									<div class="output-group col-md-12 mb-3">
										<br></br>
										<div class="output" id="basic-addon1">
											<h:outputText value="Utilizator: "></h:outputText>
											<h:outputLabel value="#{sessionBean.username}">
											</h:outputLabel>
										</div>
										<br />
									</div>

									<div>
										<div class="form-group col-md-5 mb-3">
											<h:outputText for="inputFirstName" class="control-label" value="Nume:"></h:outputText>
											<h:inputText id="firstName" type="text" class="form-control user-first-name"
												pattern="^([- \w\d\u00c0-\u024f]+)$" value="#{shoppingCartBean.firstName}" required="true"
												requiredMessage="Firstname field can't be empty!">
											</h:inputText>
										</div>

										<div class="form-group col-md-5 mb-3">
											<h:outputText for="inputLastName" class="control-label" value="Prenume:"></h:outputText>
											<h:inputText id="lastName" type="text" class="form-control user-last-name"
												pattern="^([- \w\d\u00c0-\u024f]+)$" value="#{shoppingCartBean.lastName}" required="true"
												requiredMessage="Lastname field can't be empty!" />
										</div>
									</div>

									<div>
										<br />
										<div class="form-group col-md-5 mb-6">
											<h:outputText for="inputEmail" class="control-label" value="Email:"></h:outputText>
											<h:inputText type="email" class="form-control user-email" value="#{shoppingCartBean.email}" required="true"
												validatorMessage="emailul nu e valid">
												<f:validateRegex
													pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
												<p:ajax event="blur" update="growl" listener="#{checkoutValidatioBean.isEmailValid}" />
											</h:inputText>
										</div>

										<div class="form-group col-md-5 mb-6">
											<h:outputText for="inputTelephone" class="control-label" value="Telefon:"></h:outputText>
											<h:inputText type="number" class="form-control user-telephone" pattern="07[0-9]" maxlength="10"
												minlength="10" id="telefon" value="#{shoppingCartBean.telephone}" required="true">
												<p:ajax event="blur" update="growl" listener="#{checkoutValidatioBean.isTelephoneValid}" />
											</h:inputText>

										</div>
									</div>
									<div>
										<br />
										<div class="form-group col-md-10 mb-6">
											<h:outputText for="inputAddress" class="control-label" value="Adresa:"></h:outputText>
											<h:inputText type="text" class="form-control user-address" id="adresa" value="#{shoppingCartBean.address}"
												required="true" />
										</div>
									</div>
									<div class="col-md-10 mb-6">
										<br></br>
										<h:form>
											<h:outputText for="inputPayment" class="control-label" value="Plata:"></h:outputText>

											<h:selectOneRadio value="#{shoppingCartBean.payment}" layout="pageDirection" required="true">
												<f:selectItems value="#{shoppingCartBean.paymentList}" class="user-payment" var="value" itemLabel="#{value}"
													itemValue="{value}" />
											</h:selectOneRadio>
										</h:form>
									</div>

									<div class="col-md-10 mb-6">
										<br />
										<p id="cart-validation-message" style="color: #FF0000" />
									</div>

								</form>
							</div>
							<h:form>
								<div class="modal-footer">
									<div class="" id="validate-cart">
										<br />
										<button id="checkoutModal" class="btn btn-primary btn-block send-cart-details" update="growl">Trimite
											comanda</button>

									</div>
								</div>
							</h:form>

						</div>

					</div>
				</div>
			</div>
		</div>
	</ui:define>
</ui:composition>
</html>
